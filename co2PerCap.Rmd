---
title: "HW_9 CO2"
author: "Sarah & Luis Andr√©s"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Please install and load these packages to get this .Rmd to render figures:
```{r, libraries}
library(markdown)
library(knitr)
library(kableExtra)
```

For this assignment, we use the file _data/co2_emissions_tonnes_per_person_gapminder.csv_

***
### Questions:

1. Are the data in a flat file format? 

Yes, the data is in CSV format which is a flat file format. 

```{r, echo =FALSE}
co2perCap<-read.csv("data/co2_emissions_tonnes_per_person_gapminder.csv")

```

2. What is the structure of the data?  Are there any variables you might need to convert prior to manipulating the data?

The data is structured as a "`r class(co2perCap)`", with contries as levels (`r nrow(co2perCap)`) and years (`r ncol(co2perCap)`) as variables. We did not need to convert any variables. 

3. What countries had per capita emissions larger than the 95th percentile in 2014? Make a table of their names and per capita emissions. 

We used quantile() function to find the 95% cutoff. See the answers in the table below:
```{r, echo=FALSE}
cntrys <- as.character(co2perCap$country)
dat <- co2perCap$X2014>quantile(co2perCap$X2014,0.95)
ex_tab <- data.frame("Country"=cntrys[dat], "PerCapEmissions 2014"=co2perCap$X2014[dat])
ex_tab %>%
  kable() %>%
  kable_styling()
```

4. Make a table comparing the per capita emissions of the US and the world's highest per capita emitter (from above)  in 1925, 1950, and 2014.  

```{r, echo=FALSE}
top<-which.max(co2perCap$X2014)
Top_country<-as.character(co2perCap$country[top]) #Qatar wasthe highest emiter in 2014. 
```
The largest emiter per capita was `r Top_country`. Their emission have been higher than the US only in 2014. Results are shown in the following table. 
```{r, echo=FALSE}
top<-which.max(co2perCap$X2014)
Top_country<-as.character(co2perCap$country[top]) #Qatar wasthe highest emiter in 2014. 
QT<-co2perCap$country=="Qatar" # finding the index were Qatar is true/
US<-co2perCap$country=="United States" # finding the index were United States is true. 
co2QT<-t(co2perCap[QT,c("X1925","X1950","X2014")]) # Indexing based on the country and year.  The function t() is transpose, so the table can be easily formated
co2US<-t(co2perCap[US,c("X1925","X1950","X2014")]) # Same as above but for US. 
ex_tab <- data.frame("Qatar"=co2QT, "United States"=co2US)
row.names(ex_tab) <- c("1925", "1950", "2014")
colnames(ex_tab)<-c("Qatar","United States")
ex_tab %>%
  kable() %>%
  kable_styling()
```

